Return-Path: <linux-rpi-kernel-bounces+lists+linux-rpi-kernel=lfdr.de@lists.infradead.org>
X-Original-To: lists+linux-rpi-kernel@lfdr.de
Delivered-To: lists+linux-rpi-kernel@lfdr.de
Received: from bombadil.infradead.org (bombadil.infradead.org [IPv6:2607:7c80:54:e::133])
	by mail.lfdr.de (Postfix) with ESMTPS id 73B7AAFACE
	for <lists+linux-rpi-kernel@lfdr.de>; Wed, 11 Sep 2019 12:51:33 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.infradead.org; s=bombadil.20170209; h=Sender:
	Content-Transfer-Encoding:Content-Type:Cc:List-Subscribe:List-Help:List-Post:
	List-Archive:List-Unsubscribe:List-Id:To:MIME-Version:Subject:Date:From:
	References:In-Reply-To:Message-Id:Reply-To:Content-ID:Content-Description:
	Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:
	List-Owner; bh=H12QPlotUdNYFDNPVp4eL2NmDiUxqgsouzINo0+8Tc4=; b=dhmIs8eifSZkJi
	dDA8dnqOsN3ODLlG+s2bfl1AOI7QYM4OsKafoMmAw8G6X2o1ry+zozJt3CmzWXMF40nbTaSNDr1RO
	Bj4CZWfoVmo8Nt9rYDYLKe47yf9Aqge7wID5/U0OVHYpNa//3pT9MsbYA0aZa3lnaP0ZuXZzHGch4
	LpwRgC+vGlkCfJeufuGxWWOTcjw/aXR988DGjM/du4QTBhbXjS0Xjr7jrX0MzRSrprL2LwQG7+er8
	MUfCsPMrttKwJzHFh3LA15oyU1Bsv6d6I1IW8CjD4axhjYn0W7qo6J16ZiGVqpj0DHjq686vhe8D0
	H7bnl8qjlmYeBqpkYQTQ==;
Received: from localhost ([127.0.0.1] helo=bombadil.infradead.org)
	by bombadil.infradead.org with esmtp (Exim 4.92 #3 (Red Hat Linux))
	id 1i80Da-0005x8-Qp; Wed, 11 Sep 2019 10:51:22 +0000
Received: from mailout1.hostsharing.net ([2a01:37:1000::53df:5fcc:0])
 by bombadil.infradead.org with esmtps (Exim 4.92 #3 (Red Hat Linux))
 id 1i80DX-0005wn-LH
 for linux-rpi-kernel@lists.infradead.org; Wed, 11 Sep 2019 10:51:21 +0000
Received: from h08.hostsharing.net (h08.hostsharing.net [83.223.95.28])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (Client CN "*.hostsharing.net",
 Issuer "COMODO RSA Domain Validation Secure Server CA" (not verified))
 by mailout1.hostsharing.net (Postfix) with ESMTPS id 6E66A101920FB;
 Wed, 11 Sep 2019 12:51:18 +0200 (CEST)
Received: from localhost (p57BD772B.dip0.t-ipconnect.de [87.189.119.43])
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits))
 (No client certificate requested)
 by h08.hostsharing.net (Postfix) with ESMTPSA id 319BD613C8EE;
 Wed, 11 Sep 2019 12:51:18 +0200 (CEST)
X-Mailbox-Line: From d17c1d7fcdc97fffa961b8737cfd80eeb14f9416 Mon Sep 17
 00:00:00 2001
Message-Id: <d17c1d7fcdc97fffa961b8737cfd80eeb14f9416.1568187525.git.lukas@wunner.de>
In-Reply-To: <cover.1568187525.git.lukas@wunner.de>
References: <cover.1568187525.git.lukas@wunner.de>
From: Lukas Wunner <lukas@wunner.de>
Date: Wed, 11 Sep 2019 12:15:30 +0200
Subject: [PATCH v2 06/10] spi: bcm2835: Cache CS register value for
 ->prepare_message()
MIME-Version: 1.0
To: Mark Brown <broonie@kernel.org>
X-CRM114-Version: 20100106-BlameMichelson ( TRE 0.8.0 (BSD) ) MR-646709E3 
X-CRM114-CacheID: sfid-20190911_035120_010276_99D8F0B8 
X-CRM114-Status: GOOD (  14.65  )
X-Spam-Score: 0.0 (/)
X-Spam-Report: SpamAssassin version 3.4.2 on bombadil.infradead.org summary:
 Content analysis details:   (0.0 points)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 0.0 SPF_NONE               SPF: sender does not publish an SPF Record
 0.0 SPF_HELO_NONE          SPF: HELO does not publish an SPF Record
X-BeenThere: linux-rpi-kernel@lists.infradead.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <linux-rpi-kernel.lists.infradead.org>
List-Unsubscribe: <http://lists.infradead.org/mailman/options/linux-rpi-kernel>, 
 <mailto:linux-rpi-kernel-request@lists.infradead.org?subject=unsubscribe>
List-Archive: <http://lists.infradead.org/pipermail/linux-rpi-kernel/>
List-Post: <mailto:linux-rpi-kernel@lists.infradead.org>
List-Help: <mailto:linux-rpi-kernel-request@lists.infradead.org?subject=help>
List-Subscribe: <http://lists.infradead.org/mailman/listinfo/linux-rpi-kernel>, 
 <mailto:linux-rpi-kernel-request@lists.infradead.org?subject=subscribe>
Cc: linux-rpi-kernel@lists.infradead.org, linux-spi@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: "linux-rpi-kernel" <linux-rpi-kernel-bounces@lists.infradead.org>
Errors-To: linux-rpi-kernel-bounces+lists+linux-rpi-kernel=lfdr.de@lists.infradead.org

VGhlIEJDTTI4MzUgU1BJIGRyaXZlciBuZWVkcyB0byBzZXQgdXAgdGhlIGNsb2NrIHBvbGFyaXR5
IGluIGl0cwotPnByZXBhcmVfbWVzc2FnZSgpIGhvb2sgYmVmb3JlIHNwaV90cmFuc2Zlcl9vbmVf
bWVzc2FnZSgpIGFzc2VydHMgY2hpcApzZWxlY3QgdG8gYXZvaWQgYSBncmF0dWl0b3VzIGNsb2Nr
IHNpZ25hbCBlZGdlIChjZi4gY29tbWl0IGFjYWNlNzNkZjJjMQooInNwaTogYmNtMjgzNTogc2V0
IHVwIHNwaS1tb2RlIGJlZm9yZSBhc3NlcnRpbmcgY3MtZ3BpbyIpKS4KClByZWNhbGN1bGF0ZSB0
aGUgQ1MgcmVnaXN0ZXIgdmFsdWUgKHdoaWNoIHNlbGVjdHMgdGhlIGNsb2NrIHBvbGFyaXR5KQpv
bmNlIGluIC0+c2V0dXAoKSBhbmQgdXNlIHRoYXQgY2FjaGVkIHZhbHVlIGluIC0+cHJlcGFyZV9t
ZXNzYWdlKCkgYW5kCi0+dHJhbnNmZXJfb25lKCkuICBUaGlzIGF2b2lkcyBvbmUgTU1JTyByZWFk
IHBlciBtZXNzYWdlIGFuZCBvbmUgcGVyCnRyYW5zZmVyLCB5aWVsZGluZyBhIHNtYWxsIGxhdGVu
Y3kgaW1wcm92ZW1lbnQuICBBZGRpdGlvbmFsbHksIGEKZm9ydGhjb21pbmcgY29tbWl0IHdpbGwg
dXNlIHRoZSBwcmVjYWxjdWxhdGVkIHZhbHVlIHRvIGRlcml2ZSB0aGUKcmVnaXN0ZXIgdmFsdWUg
Zm9yIGNsZWFyaW5nIHRoZSBSWCBGSUZPLCB3aGljaCB3aWxsIGVsaW1pbmF0ZSB0aGUgbmVlZApm
b3IgYW4gUlggZHVtbXkgYnVmZmVyIHdoZW4gcGVyZm9ybWluZyBUWC1vbmx5IERNQSB0cmFuc2Zl
cnMuCgpUZXN0ZWQtYnk6IE51bm8gU8OhIDxudW5vLnNhQGFuYWxvZy5jb20+ClRlc3RlZC1ieTog
Tm9yYWxmIFRyw7hubmVzIDxub3JhbGZAdHJvbm5lcy5vcmc+ClNpZ25lZC1vZmYtYnk6IEx1a2Fz
IFd1bm5lciA8bHVrYXNAd3VubmVyLmRlPgpBY2tlZC1ieTogU3RlZmFuIFdhaHJlbiA8d2FocmVu
c3RAZ214Lm5ldD4KQWNrZWQtYnk6IE1hcnRpbiBTcGVybCA8a2VybmVsQG1hcnRpbi5zcGVybC5v
cmc+Ci0tLQogZHJpdmVycy9zcGkvc3BpLWJjbTI4MzUuYyB8IDQ2ICsrKysrKysrKysrKysrKysr
KysrKystLS0tLS0tLS0tLS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDI2IGluc2VydGlvbnMoKyks
IDIwIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3BpL3NwaS1iY20yODM1LmMg
Yi9kcml2ZXJzL3NwaS9zcGktYmNtMjgzNS5jCmluZGV4IDUzMmM1OGJjZmQ0NS4uZTMwZTRhZmNm
NWY3IDEwMDY0NAotLS0gYS9kcml2ZXJzL3NwaS9zcGktYmNtMjgzNS5jCisrKyBiL2RyaXZlcnMv
c3BpL3NwaS1iY20yODM1LmMKQEAgLTY4LDYgKzY4LDcgQEAKICNkZWZpbmUgQkNNMjgzNV9TUElf
RklGT19TSVpFCQk2NAogI2RlZmluZSBCQ00yODM1X1NQSV9GSUZPX1NJWkVfM180CTQ4CiAjZGVm
aW5lIEJDTTI4MzVfU1BJX0RNQV9NSU5fTEVOR1RICTk2CisjZGVmaW5lIEJDTTI4MzVfU1BJX05V
TV9DUwkJMyAgIC8qIHJhaXNlIGFzIG5lY2Vzc2FyeSAqLwogI2RlZmluZSBCQ00yODM1X1NQSV9N
T0RFX0JJVFMJKFNQSV9DUE9MIHwgU1BJX0NQSEEgfCBTUElfQ1NfSElHSCBcCiAJCQkJfCBTUElf
Tk9fQ1MgfCBTUElfM1dJUkUpCiAKQEAgLTk0LDYgKzk1LDggQEAgTU9EVUxFX1BBUk1fREVTQyhw
b2xsaW5nX2xpbWl0X3VzLAogICogQHJ4X3Byb2xvZ3VlOiBieXRlcyByZWNlaXZlZCB3aXRob3V0
IERNQSBpZiBmaXJzdCBSWCBzZ2xpc3QgZW50cnkncwogICoJbGVuZ3RoIGlzIG5vdCBhIG11bHRp
cGxlIG9mIDQgKHRvIG92ZXJjb21lIGhhcmR3YXJlIGxpbWl0YXRpb24pCiAgKiBAdHhfc3BpbGxv
dmVyOiB3aGV0aGVyIEB0eF9wcm9sb2d1ZSBzcGlsbHMgb3ZlciB0byBzZWNvbmQgVFggc2dsaXN0
IGVudHJ5CisgKiBAcHJlcGFyZV9jczogcHJlY2FsY3VsYXRlZCBDUyByZWdpc3RlciB2YWx1ZSBm
b3IgLT5wcmVwYXJlX21lc3NhZ2UoKQorICoJKHVzZXMgc2xhdmUtc3BlY2lmaWMgY2xvY2sgcG9s
YXJpdHkgYW5kIHBoYXNlIHNldHRpbmdzKQogICogQGRlYnVnZnNfZGlyOiB0aGUgZGVidWdmcyBk
aXJlY3RvcnkgLSBuZWVkZSB0byByZW1vdmUgZGVidWdmcyB3aGVuCiAgKiAgICAgIHVubG9hZGlu
ZyB0aGUgbW9kdWxlCiAgKiBAY291bnRfdHJhbnNmZXJfcG9sbGluZzogY291bnQgb2YgaG93IG9m
dGVuIHBvbGxpbmcgbW9kZSBpcyB1c2VkCkBAIC0xMTYsNiArMTE5LDcgQEAgc3RydWN0IGJjbTI4
MzVfc3BpIHsKIAlpbnQgdHhfcHJvbG9ndWU7CiAJaW50IHJ4X3Byb2xvZ3VlOwogCXVuc2lnbmVk
IGludCB0eF9zcGlsbG92ZXI7CisJdTMyIHByZXBhcmVfY3NbQkNNMjgzNV9TUElfTlVNX0NTXTsK
IAogCXN0cnVjdCBkZW50cnkgKmRlYnVnZnNfZGlyOwogCXU2NCBjb3VudF90cmFuc2Zlcl9wb2xs
aW5nOwpAQCAtODE4LDcgKzgyMiw3IEBAIHN0YXRpYyBpbnQgYmNtMjgzNV9zcGlfdHJhbnNmZXJf
b25lKHN0cnVjdCBzcGlfY29udHJvbGxlciAqY3RsciwKIAlzdHJ1Y3QgYmNtMjgzNV9zcGkgKmJz
ID0gc3BpX2NvbnRyb2xsZXJfZ2V0X2RldmRhdGEoY3Rscik7CiAJdW5zaWduZWQgbG9uZyBzcGlf
aHosIGNsa19oeiwgY2Rpdiwgc3BpX3VzZWRfaHo7CiAJdW5zaWduZWQgbG9uZyBoel9wZXJfYnl0
ZSwgYnl0ZV9saW1pdDsKLQl1MzIgY3MgPSBiY20yODM1X3JkKGJzLCBCQ00yODM1X1NQSV9DUyk7
CisJdTMyIGNzID0gYnMtPnByZXBhcmVfY3Nbc3BpLT5jaGlwX3NlbGVjdF07CiAKIAkvKiBzZXQg
Y2xvY2sgKi8KIAlzcGlfaHogPSB0ZnItPnNwZWVkX2h6OwpAQCAtODQzLDE1ICs4NDcsNiBAQCBz
dGF0aWMgaW50IGJjbTI4MzVfc3BpX3RyYW5zZmVyX29uZShzdHJ1Y3Qgc3BpX2NvbnRyb2xsZXIg
KmN0bHIsCiAJaWYgKHNwaS0+bW9kZSAmIFNQSV8zV0lSRSAmJiB0ZnItPnJ4X2J1ZiAmJgogCSAg
ICB0ZnItPnJ4X2J1ZiAhPSBjdGxyLT5kdW1teV9yeCkKIAkJY3MgfD0gQkNNMjgzNV9TUElfQ1Nf
UkVOOwotCWVsc2UKLQkJY3MgJj0gfkJDTTI4MzVfU1BJX0NTX1JFTjsKLQotCS8qCi0JICogVGhl
IGRyaXZlciBhbHdheXMgdXNlcyBzb2Z0d2FyZS1jb250cm9sbGVkIEdQSU8gQ2hpcCBTZWxlY3Qu
Ci0JICogU2V0IHRoZSBoYXJkd2FyZS1jb250cm9sbGVkIG5hdGl2ZSBDaGlwIFNlbGVjdCB0byBh
biBpbnZhbGlkCi0JICogdmFsdWUgdG8gcHJldmVudCBpdCBmcm9tIGludGVyZmVyaW5nLgotCSAq
LwotCWNzIHw9IEJDTTI4MzVfU1BJX0NTX0NTXzEwIHwgQkNNMjgzNV9TUElfQ1NfQ1NfMDE7CiAK
IAkvKiBzZXQgdHJhbnNtaXQgYnVmZmVycyBhbmQgbGVuZ3RoICovCiAJYnMtPnR4X2J1ZiA9IHRm
ci0+dHhfYnVmOwpAQCAtODg4LDcgKzg4Myw2IEBAIHN0YXRpYyBpbnQgYmNtMjgzNV9zcGlfcHJl
cGFyZV9tZXNzYWdlKHN0cnVjdCBzcGlfY29udHJvbGxlciAqY3RsciwKIHsKIAlzdHJ1Y3Qgc3Bp
X2RldmljZSAqc3BpID0gbXNnLT5zcGk7CiAJc3RydWN0IGJjbTI4MzVfc3BpICpicyA9IHNwaV9j
b250cm9sbGVyX2dldF9kZXZkYXRhKGN0bHIpOwotCXUzMiBjcyA9IGJjbTI4MzVfcmQoYnMsIEJD
TTI4MzVfU1BJX0NTKTsKIAlpbnQgcmV0OwogCiAJaWYgKGN0bHItPmNhbl9kbWEpIHsKQEAgLTkw
MywxNCArODk3LDExIEBAIHN0YXRpYyBpbnQgYmNtMjgzNV9zcGlfcHJlcGFyZV9tZXNzYWdlKHN0
cnVjdCBzcGlfY29udHJvbGxlciAqY3RsciwKIAkJCXJldHVybiByZXQ7CiAJfQogCi0JY3MgJj0g
fihCQ00yODM1X1NQSV9DU19DUE9MIHwgQkNNMjgzNV9TUElfQ1NfQ1BIQSk7Ci0KLQlpZiAoc3Bp
LT5tb2RlICYgU1BJX0NQT0wpCi0JCWNzIHw9IEJDTTI4MzVfU1BJX0NTX0NQT0w7Ci0JaWYgKHNw
aS0+bW9kZSAmIFNQSV9DUEhBKQotCQljcyB8PSBCQ00yODM1X1NQSV9DU19DUEhBOwotCi0JYmNt
MjgzNV93cihicywgQkNNMjgzNV9TUElfQ1MsIGNzKTsKKwkvKgorCSAqIFNldCB1cCBjbG9jayBw
b2xhcml0eSBiZWZvcmUgc3BpX3RyYW5zZmVyX29uZV9tZXNzYWdlKCkgYXNzZXJ0cworCSAqIGNo
aXAgc2VsZWN0IHRvIGF2b2lkIGEgZ3JhdHVpdG91cyBjbG9jayBzaWduYWwgZWRnZS4KKwkgKi8K
KwliY20yODM1X3dyKGJzLCBCQ00yODM1X1NQSV9DUywgYnMtPnByZXBhcmVfY3Nbc3BpLT5jaGlw
X3NlbGVjdF0pOwogCiAJcmV0dXJuIDA7CiB9CkBAIC05MzYsOCArOTI3LDIzIEBAIHN0YXRpYyBp
bnQgY2hpcF9tYXRjaF9uYW1lKHN0cnVjdCBncGlvX2NoaXAgKmNoaXAsIHZvaWQgKmRhdGEpCiAK
IHN0YXRpYyBpbnQgYmNtMjgzNV9zcGlfc2V0dXAoc3RydWN0IHNwaV9kZXZpY2UgKnNwaSkKIHsK
KwlzdHJ1Y3QgYmNtMjgzNV9zcGkgKmJzID0gc3BpX2NvbnRyb2xsZXJfZ2V0X2RldmRhdGEoc3Bp
LT5jb250cm9sbGVyKTsKIAlzdHJ1Y3QgZ3Bpb19jaGlwICpjaGlwOwogCWVudW0gZ3Bpb19sb29r
dXBfZmxhZ3MgbGZsYWdzOworCXUzMiBjczsKKworCS8qCisJICogUHJlY2FsY3VsYXRlIFNQSSBz
bGF2ZSdzIENTIHJlZ2lzdGVyIHZhbHVlIGZvciAtPnByZXBhcmVfbWVzc2FnZSgpOgorCSAqIFRo
ZSBkcml2ZXIgYWx3YXlzIHVzZXMgc29mdHdhcmUtY29udHJvbGxlZCBHUElPIGNoaXAgc2VsZWN0
LCBoZW5jZQorCSAqIHNldCB0aGUgaGFyZHdhcmUtY29udHJvbGxlZCBuYXRpdmUgY2hpcCBzZWxl
Y3QgdG8gYW4gaW52YWxpZCB2YWx1ZQorCSAqIHRvIHByZXZlbnQgaXQgZnJvbSBpbnRlcmZlcmlu
Zy4KKwkgKi8KKwljcyA9IEJDTTI4MzVfU1BJX0NTX0NTXzEwIHwgQkNNMjgzNV9TUElfQ1NfQ1Nf
MDE7CisJaWYgKHNwaS0+bW9kZSAmIFNQSV9DUE9MKQorCQljcyB8PSBCQ00yODM1X1NQSV9DU19D
UE9MOworCWlmIChzcGktPm1vZGUgJiBTUElfQ1BIQSkKKwkJY3MgfD0gQkNNMjgzNV9TUElfQ1Nf
Q1BIQTsKKwlicy0+cHJlcGFyZV9jc1tzcGktPmNoaXBfc2VsZWN0XSA9IGNzOwogCiAJLyoKIAkg
KiBzYW5pdHkgY2hlY2tpbmcgdGhlIG5hdGl2ZS1jaGlwc2VsZWN0cwpAQCAtMTAxNSw3ICsxMDIx
LDcgQEAgc3RhdGljIGludCBiY20yODM1X3NwaV9wcm9iZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNl
ICpwZGV2KQogCWN0bHItPnVzZV9ncGlvX2Rlc2NyaXB0b3JzID0gdHJ1ZTsKIAljdGxyLT5tb2Rl
X2JpdHMgPSBCQ00yODM1X1NQSV9NT0RFX0JJVFM7CiAJY3Rsci0+Yml0c19wZXJfd29yZF9tYXNr
ID0gU1BJX0JQV19NQVNLKDgpOwotCWN0bHItPm51bV9jaGlwc2VsZWN0ID0gMzsKKwljdGxyLT5u
dW1fY2hpcHNlbGVjdCA9IEJDTTI4MzVfU1BJX05VTV9DUzsKIAljdGxyLT5zZXR1cCA9IGJjbTI4
MzVfc3BpX3NldHVwOwogCWN0bHItPnRyYW5zZmVyX29uZSA9IGJjbTI4MzVfc3BpX3RyYW5zZmVy
X29uZTsKIAljdGxyLT5oYW5kbGVfZXJyID0gYmNtMjgzNV9zcGlfaGFuZGxlX2VycjsKLS0gCjIu
MjMuMAoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmxp
bnV4LXJwaS1rZXJuZWwgbWFpbGluZyBsaXN0CmxpbnV4LXJwaS1rZXJuZWxAbGlzdHMuaW5mcmFk
ZWFkLm9yZwpodHRwOi8vbGlzdHMuaW5mcmFkZWFkLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2xpbnV4
LXJwaS1rZXJuZWwK
